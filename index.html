<!doctype html>
<meta charset="utf-8">
<title>Uwilno's Blog</title>
<script>
const mirrors = [
  "https://github.uwillno.com",
  "https://vercel.uwillno.com",
  "https://cloudflare.uwillno.com",
  "https://edgeone.uwillno.com",
  "https://netlify.uwillno.com",
  "https://azure.uwillno.com",
  "https://ipv6.uwillno.com:9102",
  "https://tunnel.uwillno.com"
];

const TIMEOUT = 4000;
let done = false;

function ping(url){
  return Promise.race([
    fetch(url + "/__ping__.txt?_=" + Math.random(), {
      mode: "no-cors",
      cache: "no-store"
    }).then(() => url),
    new Promise(r => setTimeout(r, TIMEOUT))
  ]);
}

mirrors.forEach(url => {
  ping(url).then(hit => {
    if(hit && !done){
      done = true;
      location.replace(hit + location.search);
    }
  });
});

// 兜底：8 秒还没跳，就让用户自己选（极少发生）
setTimeout(() => {
  if(!done) location.replace(mirrors[0] + location.search);
}, 8000);
</script>
